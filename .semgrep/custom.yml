rules:
  # --- Security ---
  - id: js-sql-injection
    patterns:
      - pattern: db.query($SQL + $VAR)
    message: ğŸš¨ SQL Injection risk - concatenated SQL query
    languages: [javascript]
    severity: ERROR

  - id: js-dangerous-eval
    pattern: eval($X)
    message: ğŸš¨ Avoid using eval(), security risk
    languages: [javascript]
    severity: ERROR

  - id: js-child-process-exec
    pattern: require('child_process').exec($CMD)
    message: ğŸš¨ Dangerous use of child_process.exec()
    languages: [javascript]
    severity: ERROR

  - id: js-hardcoded-secret
    pattern-regex: '(password|secret|apikey|api_key|token)\s*[:=]\s*["''][^"'']+["'']'
    message: ğŸ”‘ Hardcoded secret detected
    languages: [javascript]
    severity: ERROR

  # --- Bug/Quality ---
  - id: js-double-equals
    pattern: $X == $Y
    message: âš ï¸ Use === instead of ==
    languages: [javascript]
    severity: WARNING

  - id: js-unused-var
    pattern: var $X = $VAL
    message: âš ï¸ Possible unused variable
    languages: [javascript]
    severity: INFO
    metadata:
      likelihood: MEDIUM

  # --- Reliability ---
  - id: js-missing-error-handling
    patterns:
      - pattern: fs.readFile($F, $ENC, $CB)
      - pattern-not: fs.readFile($F, $ENC, function(err, $RES) { ... })
    message: âš ï¸ Missing error handling in fs.readFile callback
    languages: [javascript]
    severity: WARNING

  - id: js-console-log
    pattern: console.log($X)
    message: âš ï¸ Debug log found - consider removing in production
    languages: [javascript]
    severity: INFO
